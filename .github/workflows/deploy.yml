name: Deploy to Tencent Cloud

on:
  push:
    branches:
      - main # æˆ–è€…æ˜¯ masterï¼Œçœ‹ä½ çš„ä¸»åˆ†æ”¯å«ä»€ä¹ˆ
    paths-ignore:
      - "README.md" # æ”¹è¯´æ˜æ–‡æ¡£ä¸è§¦å‘éƒ¨ç½²

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      # 1. æ‹‰å–ä»£ç 
      - name: Checkout
        uses: actions/checkout@v4

      # 2. å®‰è£… Node.js
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: "npm"

      # 3. å®‰è£…ä¾èµ–
      - name: Install Dependencies
        run: npm ci

      # 4. æ„å»ºé¡¹ç›® (Docusaurus build)
      - name: Build
        run: npm run build

      # 5. æŠŠæ„å»ºå¥½çš„æ–‡ä»¶æ¨é€åˆ°æœåŠ¡å™¨
      - name: Deploy to Server
        uses: easingthemes/ssh-deploy@main
        env:
          SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
          ARGS: "-rlgoDzvc -i"
          SOURCE: "build/" # Docusaurus æ‰“åŒ…å‡ºæ¥çš„æ–‡ä»¶å¤¹
          REMOTE_HOST: ${{ secrets.REMOTE_HOST }}
          REMOTE_USER: ${{ secrets.REMOTE_USER }}
          # ğŸ‘‡ âš ï¸âš ï¸âš ï¸ é‡ç‚¹ï¼šä¿®æ”¹æˆä½ æœåŠ¡å™¨ä¸Š WordPress æ ¹ç›®å½•ä¸‹çš„ docs æ–‡ä»¶å¤¹è·¯å¾„
          # é€šå¸¸æ˜¯ /www/wwwroot/ä½ çš„åŸŸå/docs
          TARGET: "/usr/local/lighthouse/softwares/wordpress/docs"
          # âš ï¸ å¦‚æœä½ çš„æœåŠ¡å™¨ç›®å½•ä¸å«è¿™ä¸ªï¼Œè¯·åŠ¡å¿…ä¿®æ”¹ä¸Šé¢è¿™è¡Œï¼
